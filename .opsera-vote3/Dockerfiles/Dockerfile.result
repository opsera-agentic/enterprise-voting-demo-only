# Result Service Dockerfile - Cloud Database Ready
# Generated by Opsera Code-to-Cloud Enterprise v0.905

FROM node:18-slim

WORKDIR /app

# Install dependencies
COPY result/package*.json ./
RUN npm install --legacy-peer-deps

# Copy application
COPY result/ .

# Environment variables for cloud database connection
# These are injected via K8s ConfigMap/Secrets
ENV DATABASE_HOST=""
ENV DATABASE_PORT="5432"
ENV DATABASE_NAME="votes"
ENV DATABASE_USER="app_user"
ENV DATABASE_USE_IAM_AUTH="true"
ENV PORT="80"

EXPOSE 80

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 \
  CMD curl -f http://localhost:80/ || exit 1

CMD ["node", "server.js"]
